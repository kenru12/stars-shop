<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Stars Shop Gold</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –£–±–∏—Ä–∞–µ–º —Å–∏–Ω–µ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –±–∞–∑—É */
        * {
            -webkit-tap-highlight-color: transparent;
            outline: none;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            user-select: none;
        }

        body {
            background-color: #000;
            color: white;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* –§–æ–Ω —Å –ø–∞–¥–∞—é—â–∏–º–∏ –ó–í–ï–ó–î–ê–ú–ò */
        #stars-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .page {
            display: none;
            flex-direction: column;
            width: 100%;
            height: 100vh;
            padding: 16px;
            padding-bottom: 120px;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
        }

        .page.active { display: flex; }

        /* –ë–õ–û–ö –ü–†–û–§–ò–õ–Ø –°–í–ï–†–•–£ */
        .header-profile {
            background: rgba(28, 28, 30, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
            border: 1px solid rgba(255,255,255,0.1);
            cursor: pointer;
        }

        .user-info { display: flex; align-items: center; gap: 12px; }
        .avatar { width: 44px; height: 44px; border-radius: 50%; border: 2px solid #ead4aa; object-fit: cover; }
        .name-box { display: flex; flex-direction: column; }
        .name { font-weight: 700; font-size: 16px; }
        .level-text { font-size: 11px; color: #ead4aa; text-transform: uppercase; font-weight: 800; }

        /* –ë–õ–û–ö –î–û–°–¢–ò–ñ–ï–ù–ò–ô */
        .achievements-row {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        .ach-item {
            min-width: 100px;
            background: rgba(44, 44, 46, 0.5);
            padding: 10px;
            border-radius: 14px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.05);
        }
        .ach-icon { font-size: 20px; display: block; margin-bottom: 4px; }
        .ach-title { font-size: 10px; color: #8e8e93; font-weight: 600; }

        /* –°–ï–¢–ö–ê –¢–û–í–ê–†–û–í */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px; }
        .card {
            background: rgba(28, 28, 30, 0.8);
            border-radius: 18px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.05);
            transition: 0.2s;
        }
        .card.selected { border: 1px solid #ead4aa; background: rgba(44, 44, 46, 0.8); }
        .card-val { font-size: 22px; font-weight: 800; color: #ead4aa; }
        .card-price { font-size: 12px; color: #8e8e93; margin-top: 4px; }

        /* –ü–û–õ–ï –í–í–û–î–ê */
        .input-group {
            background: rgba(28, 28, 30, 0.8);
            border-radius: 16px;
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .input-group input {
            background: transparent; border: none; color: white; font-size: 17px; width: 60%; font-weight: 600;
        }
        .hint { color: rgba(255, 255, 255, 0.3); font-size: 16px; }

        /* –ù–ò–ñ–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ */
        .bottom-bar {
            position: fixed;
            bottom: 20px;
            left: 15px;
            right: 15px;
            background: rgba(25, 25, 25, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 10px;
            display: flex;
            gap: 10px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .tab-btn {
            flex: 1;
            background: #1c1c1e;
            color: #888;
            border: none;
            padding: 12px;
            border-radius: 16px;
            font-weight: 700;
            font-size: 14px;
            transition: 0.3s;
        }
        .tab-btn.active { background: #333; color: white; }
        
        .pay-btn {
            background: #2ea043;
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 16px;
            font-weight: 700;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(46, 160, 67, 0.3);
        }

        /* –ü–†–û–§–ò–õ–¨ */
        .prof-header { text-align: center; margin: 30px 0; }
        .big-avatar { width: 90px; height: 90px; border-radius: 50%; border: 3px solid #ead4aa; margin-bottom: 15px; }
        .stat-card { background: #1c1c1e; border-radius: 16px; padding: 20px; margin-bottom: 12px; }
        .ref-box { background: #000; padding: 12px; border-radius: 12px; border: 1px dashed #333; color: #ead4aa; font-size: 13px; margin-top: 10px; }

        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body>

    <canvas id="stars-canvas"></canvas>

    <div id="shop-page" class="page active">
        <div class="header-profile" onclick="showPage('profile-page')">
            <div class="user-info">
                <img src="" class="avatar" id="hdr-avatar">
                <div class="name-box">
                    <span class="name" id="hdr-name">User</span>
                    <span class="level-text">Level 1 ‚Ä¢ –ù–æ–≤–∏—á–æ–∫</span>
                </div>
            </div>
            <span>‚ûî</span>
        </div>

        <div class="achievements-row">
            <div class="ach-item"><span class="ach-icon">üõ°</span><span class="ach-title">–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</span></div>
            <div class="ach-item"><span class="ach-icon">‚ö°Ô∏è</span><span class="ach-title">–ë—ã—Å—Ç—Ä–∞—è –≤—ã–¥–∞—á–∞</span></div>
            <div class="ach-item"><span class="ach-icon">üî•</span><span class="ach-title">–¢–æ–ø –ø–æ–∫—É–ø–∞—Ç–µ–ª—å</span></div>
        </div>

        <div id="stars-content">
            <div class="grid">
                <div class="card" onclick="select(50, 80)">
                    <div class="card-val">50</div>
                    <div class="card-price">80 ‚ÇΩ</div>
                </div>
                <div class="card" onclick="select(100, 160)">
                    <div class="card-val">100</div>
                    <div class="card-price">160 ‚ÇΩ</div>
                </div>
                <div class="card" onclick="select(250, 400)">
                    <div class="card-val">250</div>
                    <div class="card-price">400 ‚ÇΩ</div>
                </div>
                <div class="card" onclick="select(500, 800)">
                    <div class="card-val">500</div>
                    <div class="card-price">800 ‚ÇΩ</div>
                </div>
            </div>
            <div class="input-group">
                <input type="number" id="custom" placeholder="–õ—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ">
                <span class="hint" id="hint">0 ‚ÇΩ</span>
            </div>
        </div>

        <div id="prem-content" style="display:none;">
            <div class="grid">
                <div class="card" style="border-radius:12px;" onclick="select('3M', 350)">
                    <div class="card-val">3 –º–µ—Å.</div>
                    <div class="card-price">350 ‚ÇΩ</div>
                </div>
                <div class="card" style="border-radius:12px;" onclick="select('12M', 950)">
                    <div class="card-val">1 –≥–æ–¥</div>
                    <div class="card-price">950 ‚ÇΩ</div>
                </div>
            </div>
        </div>
    </div>

    <div id="profile-page" class="page">
        <div class="prof-header">
            <img src="" class="big-avatar" id="prof-avatar">
            <h2 id="prof-name">User</h2>
            <div style="color:#ead4aa; font-weight:800;">LEVEL 1</div>
        </div>
        
        <div class="stat-card">
            <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                <span>–ü–æ–∫—É–ø–æ–∫:</span><b>0 ‚ÇΩ</b>
            </div>
            <div style="display:flex; justify-content:space-between;">
                <span>–†–µ—Ñ–µ—Ä–∞–ª–æ–≤:</span><b>0</b>
            </div>
        </div>

        <div class="stat-card">
            <b>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (5%)</b>
            <div class="ref-box" id="ref-link">loading...</div>
            <button onclick="copyRef()" style="background:#333; color:white; border:none; width:100%; padding:10px; border-radius:10px; margin-top:10px;">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
        </div>

        <button onclick="showPage('shop-page')" style="background:none; color:#888; border:none; width:100%; margin-top:20px;">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–∞–≥–∞–∑–∏–Ω</button>
    </div>

    <div class="bottom-bar">
        <button class="tab-btn active" id="btn-stars" onclick="setTab('stars')">Stars</button>
        <button class="tab-btn" id="btn-prem" onclick="setTab('prem')">Premium</button>
        <button class="pay-btn" onclick="pay()" id="pay-txt">–û–ø–ª–∞—Ç–∏—Ç—å</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        const RATE = 1.6;
        let selected = null;

        // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = tg.initDataUnsafe.user || { first_name: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', id: 0 };
        document.getElementById('hdr-name').innerText = user.first_name;
        document.getElementById('prof-name').innerText = user.first_name;
        document.getElementById('ref-link').innerText = `t.me/StarsShopBot?start=${user.id}`;
        const avatar = user.photo_url || "https://cdn-icons-png.flaticon.com/512/149/149071.png";
        document.getElementById('hdr-avatar').src = avatar;
        document.getElementById('prof-avatar').src = avatar;

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function setTab(type) {
            document.getElementById('stars-content').style.display = type === 'stars' ? 'block' : 'none';
            document.getElementById('prem-content').style.display = type === 'prem' ? 'block' : 'none';
            document.getElementById('btn-stars').classList.toggle('active', type === 'stars');
            document.getElementById('btn-prem').classList.toggle('active', type === 'prem');
            selected = null;
            document.getElementById('pay-txt').innerText = "–û–ø–ª–∞—Ç–∏—Ç—å";
        }

        function select(val, price) {
            selected = { val, price };
            document.querySelectorAll('.card').forEach(c => c.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            document.getElementById('pay-txt').innerText = `–û–ø–ª–∞—Ç–∏—Ç—å ${price} ‚ÇΩ`;
        }

        document.getElementById('custom').addEventListener('input', (e) => {
            const v = e.target.value;
            if(v > 0) {
                const p = Math.ceil(v * RATE);
                document.getElementById('hint').innerText = `${p} ‚ÇΩ`;
                document.getElementById('pay-txt').innerText = `–û–ø–ª–∞—Ç–∏—Ç—å ${p} ‚ÇΩ`;
                selected = { val: v, price: p };
            }
        });

        function pay() {
            if(!selected) return tg.showAlert("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä");
            tg.sendData(JSON.stringify(selected));
        }

        function copyRef() {
            navigator.clipboard.writeText(document.getElementById('ref-link').innerText);
            tg.showAlert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!");
        }

        // –ê–ù–ò–ú–ê–¶–ò–Ø –ó–í–ï–ó–î
        const canvas = document.getElementById('stars-canvas');
        const ctx = canvas.getContext('2d');
        let w, h, stars = [];

        function init() {
            w = canvas.width = window.innerWidth;
            h = canvas.height = window.innerHeight;
            stars = [];
            for(let i=0; i<60; i++) stars.push({
                x: Math.random() * w,
                y: Math.random() * h,
                s: Math.random() * 2 + 1,
                v: Math.random() * 0.5 + 0.2,
                o: Math.random()
            });
        }

        function drawStar(x, y, size, opacity) {
            ctx.fillStyle = `rgba(255, 255, 255, ${opacity})`;
            ctx.beginPath();
            ctx.arc(x, y, size, 0, Math.PI * 2);
            ctx.fill();
        }

        function anim() {
            ctx.clearRect(0,0,w,h);
            stars.forEach(s => {
                s.y += s.v;
                if(s.y > h) s.y = -10;
                s.o += 0.01;
                let op = Math.abs(Math.sin(s.o)) * 0.8;
                drawStar(s.x, s.y, s.s, op);
            });
            requestAnimationFrame(anim);
        }

        window.onresize = init;
        init();
        anim();
    </script>
</body>

</html>
